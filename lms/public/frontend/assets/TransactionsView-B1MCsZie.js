import{d as H,r,b as f,c as p,a as e,e as _,f as u,g as C,u as d,E as S,G as I,t as l,x as Q,w as i,i as J,v as m,j as T,F as K,k as W,l as D,n as $,A as Y,B as Z,H as ee,o as v}from"./index-Di7ZQu8m.js";import{r as te}from"./ClockIcon-Bw__AIAu.js";import{r as se}from"./EyeIcon-Dqe4Gm_d.js";const oe={class:"space-y-6"},le={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},ae={class:"mt-4 sm:mt-0 flex flex-col sm:flex-row gap-3"},ne={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},de={class:"stats-card"},re={class:"flex items-center"},ie={class:"flex-shrink-0"},ue={class:"w-12 h-12 bg-gradient-primary rounded-xl flex items-center justify-center"},ce={class:"ml-4"},me={class:"text-2xl font-bold text-secondary-900"},ve={class:"stats-card"},be={class:"flex items-center"},pe={class:"flex-shrink-0"},xe={class:"w-12 h-12 bg-gradient-success rounded-xl flex items-center justify-center"},fe={class:"ml-4"},ye={class:"text-2xl font-bold text-secondary-900"},ge={class:"stats-card"},we={class:"flex items-center"},he={class:"flex-shrink-0"},ke={class:"w-12 h-12 bg-gradient-warning rounded-xl flex items-center justify-center"},_e={class:"ml-4"},Ie={class:"text-2xl font-bold text-secondary-900"},De={class:"stats-card"},Ce={class:"flex items-center"},Se={class:"flex-shrink-0"},Te={class:"w-12 h-12 bg-gradient-danger rounded-xl flex items-center justify-center"},Be={class:"ml-4"},Ve={class:"text-2xl font-bold text-secondary-900"},Ne={class:"card"},$e={class:"card-body"},Le={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},Ue={class:"md:col-span-2"},je={class:"relative"},Ae={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},qe={class:"card"},Fe={class:"card-header"},Me={class:"text-lg font-semibold text-secondary-900"},Oe={class:"overflow-x-auto"},Re={class:"table"},Xe={class:"table-body"},Pe={class:"table-cell font-medium"},Ee={class:"table-cell"},ze={class:"text-sm font-medium text-secondary-900"},Ge={class:"text-sm text-secondary-500"},He={class:"table-cell"},Qe={class:"text-sm font-medium text-secondary-900"},Je={class:"text-sm text-secondary-500"},Ke={class:"table-cell"},We={class:"table-cell"},Ye={class:"table-cell"},Ze={class:"table-cell"},et={class:"table-cell text-right"},tt={class:"flex items-center justify-end space-x-2"},st=["onClick"],ot=["onClick"],lt=["onClick"],at={class:"modal-body space-y-4"},nt={class:"modal-footer"},dt={class:"modal-body space-y-4"},rt={class:"modal-footer"},vt=H({__name:"TransactionsView",setup(it){const b=r(""),g=r(""),w=r(""),h=r(""),L=r(1),B=r(10),y=r(!1),x=r(!1),c=r({memberId:"",bookId:"",dueDate:""}),a=r({transactionId:"",returnDate:new Date().toISOString().split("T")[0],condition:"",notes:""}),n=r([{id:1,transactionId:"TXN001",bookTitle:"الأسود يليق بك",bookAuthor:"أحلام مستغانمي",memberName:"أحمد محمد",memberId:"LIB001",type:"borrow",issueDate:"2024-01-15",dueDate:"2024-02-15",returnDate:null,status:"active"},{id:2,transactionId:"TXN002",bookTitle:"مئة عام من العزلة",bookAuthor:"غابرييل غارسيا ماركيز",memberName:"فاطمة أحمد",memberId:"LIB002",type:"return",issueDate:"2024-01-10",dueDate:"2024-02-10",returnDate:"2024-01-20",status:"returned"},{id:3,transactionId:"TXN003",bookTitle:"1984",bookAuthor:"جورج أورويل",memberName:"محمد سالم",memberId:"LIB003",type:"borrow",issueDate:"2024-01-05",dueDate:"2024-01-20",returnDate:null,status:"overdue"}]),U=f(()=>{const o=new Date().toISOString().split("T")[0];return n.value.filter(t=>t.issueDate===o&&t.type==="borrow").length}),j=f(()=>{const o=new Date().toISOString().split("T")[0];return n.value.filter(t=>t.returnDate===o).length}),A=f(()=>n.value.filter(o=>o.status==="active").length),q=f(()=>n.value.filter(o=>o.status==="overdue").length),V=f(()=>n.value.filter(o=>{const t=!b.value||o.bookTitle.toLowerCase().includes(b.value.toLowerCase())||o.memberName.toLowerCase().includes(b.value.toLowerCase())||o.memberId.toLowerCase().includes(b.value.toLowerCase())||o.transactionId.toLowerCase().includes(b.value.toLowerCase()),s=!g.value||o.type===g.value,k=!w.value||o.status===w.value,G=!h.value||o.issueDate===h.value;return t&&s&&k&&G})),F=f(()=>{const o=(L.value-1)*B.value,t=o+B.value;return V.value.slice(o,t)}),M=o=>{switch(o){case"active":return"badge-primary";case"returned":return"badge-success";case"overdue":return"badge-danger";default:return"badge-secondary"}},O=o=>{switch(o){case"active":return"نشط";case"returned":return"مرجع";case"overdue":return"متأخر";default:return o}},N=o=>new Date(o).toLocaleDateString("ar-SA"),R=()=>{const o={id:n.value.length+1,transactionId:`TXN${String(n.value.length+1).padStart(3,"0")}`,bookTitle:"كتاب عينة",bookAuthor:"مؤلف عينة",memberName:"عضو عينة",memberId:c.value.memberId,type:"borrow",issueDate:new Date().toISOString().split("T")[0],dueDate:c.value.dueDate,returnDate:null,status:"active"};n.value.push(o),c.value={memberId:"",bookId:"",dueDate:""},y.value=!1},X=()=>{const o=n.value.findIndex(t=>t.transactionId===a.value.transactionId);o>-1&&(n.value[o].returnDate=a.value.returnDate,n.value[o].status="returned",n.value[o].type="return"),a.value={transactionId:"",returnDate:new Date().toISOString().split("T")[0],condition:"",notes:""},x.value=!1},P=o=>{console.log("View transaction:",o)},E=o=>{a.value.transactionId=o.transactionId,x.value=!0},z=o=>{console.log("Send reminder for:",o)};return(o,t)=>(v(),p("div",oe,[e("div",le,[t[21]||(t[21]=e("div",null,[e("h1",{class:"text-3xl font-bold text-secondary-900"},"إدارة المعاملات"),e("p",{class:"mt-2 text-secondary-600"},"تتبع عمليات الاستعارة والإرجاع")],-1)),e("div",ae,[e("button",{onClick:t[0]||(t[0]=s=>y.value=!0),class:"btn-primary"},[u(d(S),{class:"w-4 h-4 mr-2"}),t[19]||(t[19]=C(" إصدار كتاب ",-1))]),e("button",{onClick:t[1]||(t[1]=s=>x.value=!0),class:"btn-secondary"},[u(d(I),{class:"w-4 h-4 mr-2"}),t[20]||(t[20]=C(" إرجاع كتاب ",-1))])])]),e("div",ne,[e("div",de,[e("div",re,[e("div",ie,[e("div",ue,[u(d(S),{class:"w-6 h-6 text-white"})])]),e("div",ce,[t[22]||(t[22]=e("p",{class:"text-sm font-medium text-secondary-600"},"كتب صدرت اليوم",-1)),e("p",me,l(U.value),1)])])]),e("div",ve,[e("div",be,[e("div",pe,[e("div",xe,[u(d(I),{class:"w-6 h-6 text-white"})])]),e("div",fe,[t[23]||(t[23]=e("p",{class:"text-sm font-medium text-secondary-600"},"كتب أرجعت اليوم",-1)),e("p",ye,l(j.value),1)])])]),e("div",ge,[e("div",we,[e("div",he,[e("div",ke,[u(d(te),{class:"w-6 h-6 text-white"})])]),e("div",_e,[t[24]||(t[24]=e("p",{class:"text-sm font-medium text-secondary-600"},"مستعارة حالياً",-1)),e("p",Ie,l(A.value),1)])])]),e("div",De,[e("div",Ce,[e("div",Se,[e("div",Te,[u(d(Q),{class:"w-6 h-6 text-white"})])]),e("div",Be,[t[25]||(t[25]=e("p",{class:"text-sm font-medium text-secondary-600"},"كتب متأخرة",-1)),e("p",Ve,l(q.value),1)])])])]),e("div",Ne,[e("div",$e,[e("div",Le,[e("div",Ue,[e("div",je,[e("div",Ae,[u(d(J),{class:"h-5 w-5 text-secondary-400"})]),i(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>b.value=s),type:"text",placeholder:"البحث بعنوان الكتاب، اسم العضو، أو رقم المعاملة...",class:"form-input pl-10"},null,512),[[m,b.value]])])]),e("div",null,[i(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>g.value=s),class:"form-select"},t[26]||(t[26]=[e("option",{value:""},"جميع الأنواع",-1),e("option",{value:"borrow"},"استعارة",-1),e("option",{value:"return"},"إرجاع",-1)]),512),[[T,g.value]])]),e("div",null,[i(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>w.value=s),class:"form-select"},t[27]||(t[27]=[e("option",{value:""},"جميع الحالات",-1),e("option",{value:"active"},"نشط",-1),e("option",{value:"returned"},"مرجع",-1),e("option",{value:"overdue"},"متأخر",-1)]),512),[[T,w.value]])]),e("div",null,[i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>h.value=s),type:"date",class:"form-input"},null,512),[[m,h.value]])])])])]),e("div",qe,[e("div",Fe,[e("h3",Me," المعاملات ("+l(V.value.length)+") ",1)]),e("div",Oe,[e("table",Re,[t[28]||(t[28]=e("thead",{class:"table-header"},[e("tr",null,[e("th",null,"رقم المعاملة"),e("th",null,"الكتاب"),e("th",null,"العضو"),e("th",null,"النوع"),e("th",null,"تاريخ الإصدار"),e("th",null,"تاريخ الاستحقاق"),e("th",null,"الحالة"),e("th",{class:"text-right"},"الإجراءات")])],-1)),e("tbody",Xe,[(v(!0),p(K,null,W(F.value,s=>(v(),p("tr",{key:s.id,class:"table-row"},[e("td",Pe,l(s.transactionId),1),e("td",Ee,[e("div",null,[e("div",ze,l(s.bookTitle),1),e("div",Ge,l(s.bookAuthor),1)])]),e("td",He,[e("div",null,[e("div",Qe,l(s.memberName),1),e("div",Je,l(s.memberId),1)])]),e("td",Ke,[e("span",{class:$(["badge",s.type==="borrow"?"badge-primary":"badge-success"])},[(v(),Y(Z(s.type==="borrow"?d(S):d(I)),{class:"w-3 h-3 mr-1"})),C(" "+l(s.type==="borrow"?"استعارة":"إرجاع"),1)],2)]),e("td",We,l(N(s.issueDate)),1),e("td",Ye,l(s.dueDate?N(s.dueDate):"-"),1),e("td",Ze,[e("span",{class:$(["badge",M(s.status)])},l(O(s.status)),3)]),e("td",et,[e("div",tt,[e("button",{onClick:k=>P(s),class:"p-1 text-primary-600 hover:text-primary-800 rounded",title:"عرض التفاصيل"},[u(d(se),{class:"h-4 w-4"})],8,st),s.status==="active"?(v(),p("button",{key:0,onClick:k=>E(s),class:"p-1 text-success-600 hover:text-success-800 rounded",title:"إرجاع الكتاب"},[u(d(I),{class:"h-4 w-4"})],8,ot)):_("",!0),s.status==="overdue"?(v(),p("button",{key:1,onClick:k=>z(s),class:"p-1 text-warning-600 hover:text-warning-800 rounded",title:"إرسال تذكير"},[u(d(ee),{class:"h-4 w-4"})],8,lt)):_("",!0)])])]))),128))])])])]),y.value?(v(),p("div",{key:0,class:"modal-overlay",onClick:t[11]||(t[11]=s=>y.value=!1)},[e("div",{class:"modal-container",onClick:t[10]||(t[10]=D(()=>{},["stop"]))},[t[33]||(t[33]=e("div",{class:"modal-header"},[e("h3",{class:"text-lg font-semibold text-secondary-900"},"إصدار كتاب")],-1)),e("form",{onSubmit:D(R,["prevent"])},[e("div",at,[e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-secondary-700 mb-1"},"رقم العضوية",-1)),i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>c.value.memberId=s),type:"text",required:"",class:"form-input",placeholder:"أدخل رقم العضوية"},null,512),[[m,c.value.memberId]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-secondary-700 mb-1"},"ISBN أو عنوان الكتاب",-1)),i(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>c.value.bookId=s),type:"text",required:"",class:"form-input",placeholder:"أدخل ISBN أو عنوان الكتاب"},null,512),[[m,c.value.bookId]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-secondary-700 mb-1"},"تاريخ الاستحقاق",-1)),i(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>c.value.dueDate=s),type:"date",required:"",class:"form-input"},null,512),[[m,c.value.dueDate]])])]),e("div",nt,[e("button",{type:"button",onClick:t[9]||(t[9]=s=>y.value=!1),class:"btn-secondary"}," إلغاء "),t[32]||(t[32]=e("button",{type:"submit",class:"btn-primary"}," إصدار الكتاب ",-1))])],32)])])):_("",!0),x.value?(v(),p("div",{key:1,class:"modal-overlay",onClick:t[18]||(t[18]=s=>x.value=!1)},[e("div",{class:"modal-container",onClick:t[17]||(t[17]=D(()=>{},["stop"]))},[t[40]||(t[40]=e("div",{class:"modal-header"},[e("h3",{class:"text-lg font-semibold text-secondary-900"},"إرجاع كتاب")],-1)),e("form",{onSubmit:D(X,["prevent"])},[e("div",dt,[e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-secondary-700 mb-1"},"رقم المعاملة",-1)),i(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>a.value.transactionId=s),type:"text",required:"",class:"form-input",placeholder:"أدخل رقم المعاملة"},null,512),[[m,a.value.transactionId]])]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-secondary-700 mb-1"},"تاريخ الإرجاع",-1)),i(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>a.value.returnDate=s),type:"date",required:"",class:"form-input"},null,512),[[m,a.value.returnDate]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-secondary-700 mb-1"},"حالة الكتاب",-1)),i(e("select",{"onUpdate:modelValue":t[14]||(t[14]=s=>a.value.condition=s),required:"",class:"form-select"},t[36]||(t[36]=[e("option",{value:""},"اختر حالة الكتاب",-1),e("option",{value:"good"},"جيدة",-1),e("option",{value:"fair"},"مقبولة",-1),e("option",{value:"damaged"},"تالفة",-1)]),512),[[T,a.value.condition]])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-secondary-700 mb-1"},"ملاحظات",-1)),i(e("textarea",{"onUpdate:modelValue":t[15]||(t[15]=s=>a.value.notes=s),rows:"3",class:"form-textarea",placeholder:"أدخل أي ملاحظات إضافية"},null,512),[[m,a.value.notes]])])]),e("div",rt,[e("button",{type:"button",onClick:t[16]||(t[16]=s=>x.value=!1),class:"btn-secondary"}," إلغاء "),t[39]||(t[39]=e("button",{type:"submit",class:"btn-success"}," إرجاع الكتاب ",-1))])],32)])])):_("",!0)]))}});export{vt as default};
